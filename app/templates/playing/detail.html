{% extends "base.html" %}
{% block title %}{{ game.name }} — Game Journal{% endblock %}

{% block content %}
<div class="max-w-xl">

  <!-- Back -->
  <a href="{{ url_for('playing.index') }}"
     class="text-sm text-gray-500 hover:text-white transition-colors">← Active Library</a>

  <!-- Header -->
  <div class="flex gap-6 mt-4 mb-8">
    {% if game.cover_url %}
      <img src="{{ game.cover_url }}" alt="{{ game.name }}"
           class="w-28 h-40 object-cover rounded-lg shrink-0">
    {% else %}
      <div class="w-28 h-40 bg-gray-800 rounded-lg shrink-0"></div>
    {% endif %}

    <div class="flex flex-col justify-between py-1">
      <div>
        <h1 class="text-2xl font-bold leading-tight">{{ game.name }}</h1>
        {% if game.release_year %}
          <p class="text-sm text-gray-500 mt-1">{{ game.release_year }}</p>
        {% endif %}
        {% if game.genres %}
          <p class="text-sm text-gray-500">{{ game.genres }}</p>
        {% endif %}
      </div>
      <a href="{{ url_for('playing.edit', game_id=game.id) }}"
         class="self-start px-4 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm transition-colors">
        Edit
      </a>
    </div>
  </div>

  <!-- Status -->
  <section class="bg-gray-900 rounded-xl p-5 mb-4">
    <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Status</h2>
    <form method="post" action="{{ url_for('playing.set_status', game_id=game.id) }}"
          class="flex flex-wrap gap-2">
      {% for s in statuses %}
        <button name="status" value="{{ s }}" type="submit"
                class="px-4 py-1.5 rounded text-sm font-medium transition-colors
                  {% if game.status == s %}
                    {% if s == 'Playing' %}bg-green-700 text-green-100
                    {% elif s == 'On Hold' %}bg-yellow-700 text-yellow-100
                    {% elif s == 'Dropped' %}bg-red-800 text-red-200
                    {% elif s == 'Completed' %}bg-blue-800 text-blue-200{% endif %}
                  {% else %}
                    bg-gray-800 text-gray-400 hover:bg-gray-700
                  {% endif %}">
          {{ s }}
        </button>
      {% endfor %}
    </form>
  </section>

  <!-- Ratings -->
  <section class="bg-gray-900 rounded-xl p-5 mb-4">
    <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Ratings</h2>
    <div class="flex flex-col gap-2 text-sm">
      <div class="flex items-center gap-3">
        <span class="w-20 text-gray-400">Enjoyment</span>
        <span class="text-yellow-400 tracking-tight">
          {% for i in range(1, 6) %}
            {% if game.enjoyment and i <= game.enjoyment %}★{% else %}<span class="text-gray-700">★</span>{% endif %}
          {% endfor %}
        </span>
        {% if not game.enjoyment %}<span class="text-gray-600 text-xs">unrated</span>{% endif %}
      </div>
      <div class="flex items-center gap-3">
        <span class="w-20 text-gray-400">Motivation</span>
        <span class="text-yellow-400 tracking-tight">
          {% for i in range(1, 6) %}
            {% if game.motivation and i <= game.motivation %}★{% else %}<span class="text-gray-700">★</span>{% endif %}
          {% endfor %}
        </span>
        {% if not game.motivation %}<span class="text-gray-600 text-xs">unrated</span>{% endif %}
      </div>
    </div>
  </section>

  <!-- Notes -->
  {% if game.notes %}
  <section class="bg-gray-900 rounded-xl p-5 mb-4">
    <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Notes</h2>
    <p class="text-sm text-gray-300 whitespace-pre-wrap">{{ game.notes }}</p>
  </section>
  {% endif %}

  <!-- Platforms -->
  {% if game.platforms %}
  <section class="bg-gray-900 rounded-xl p-5 mb-6">
    <h2 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Platforms</h2>
    <p class="text-sm text-gray-400">{{ game.platforms }}</p>
  </section>
  {% endif %}

  <!-- Delete -->
  <form method="post" action="{{ url_for('playing.delete', game_id=game.id) }}"
        onsubmit="return confirm('Remove {{ game.name }}?')">
    <button type="submit"
            class="text-sm text-red-500 hover:text-red-400 transition-colors">
      Remove from library
    </button>
  </form>

</div>
{% endblock %}
